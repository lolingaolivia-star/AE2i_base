<!DOCTYPE html>

<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AE2i - Base de données</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #1e40af 0%, #3b82f6 50%, #fbbf24 100%);
        min-height: 100vh;
        color: #1f2937;
    }

    .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
    }

    .login-container {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
    }

    .login-box {
        background: white;
        padding: 40px;
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        text-align: center;
        max-width: 400px;
        width: 100%;
    }

    .logo {
        font-size: 2.5em;
        font-weight: bold;
        color: #1e40af;
        margin-bottom: 10px;
    }

    .subtitle {
        color: #6b7280;
        margin-bottom: 30px;
    }

    input[type="password"], input[type="text"], input[type="email"], input[type="tel"], 
    input[type="date"], textarea, select, input[type="file"] {
        width: 100%;
        padding: 15px;
        border: 2px solid #e5e7eb;
        border-radius: 10px;
        font-size: 16px;
        margin-bottom: 20px;
        transition: all 0.3s ease;
    }

    input:focus, textarea:focus, select:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    .btn {
        padding: 15px 30px;
        border: none;
        border-radius: 10px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-block;
        text-align: center;
        margin: 5px;
    }

    .btn-primary {
        background: linear-gradient(45deg, #1e40af, #3b82f6);
        color: white;
    }

    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(59, 130, 246, 0.3);
    }

    .btn-warning {
        background: linear-gradient(45deg, #f59e0b, #fbbf24);
        color: white;
    }

    .btn-warning:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(245, 158, 11, 0.3);
    }

    .btn-danger {
        background: linear-gradient(45deg, #dc2626, #ef4444);
        color: white;
    }

    .btn-danger:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(220, 38, 38, 0.3);
    }

    .btn-success {
        background: linear-gradient(45deg, #059669, #10b981);
        color: white;
    }

    .btn-success:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(5, 150, 105, 0.3);
    }

    .btn-small {
        padding: 8px 16px;
        font-size: 14px;
    }

    .main-container {
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        overflow: hidden;
        margin-top: 20px;
    }

    .header {
        background: linear-gradient(135deg, #1e40af, #3b82f6);
        color: white;
        padding: 30px;
        text-align: center;
    }

    .nav-tabs {
        display: flex;
        background: #f8fafc;
        border-bottom: 2px solid #e5e7eb;
        overflow-x: auto;
    }

    .nav-tab {
        flex: 1;
        padding: 20px;
        text-align: center;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
        border-bottom: 3px solid transparent;
        white-space: nowrap;
        min-width: 120px;
    }

    .nav-tab:hover {
        background: #e0e7ff;
    }

    .nav-tab.active {
        background: #3b82f6;
        color: white;
        border-bottom-color: #fbbf24;
    }

    .tab-content {
        padding: 40px;
    }

    .hidden {
        display: none;
    }

    .member-card, .commission-card {
        background: #f8fafc;
        border: 2px solid #e5e7eb;
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 20px;
        transition: all 0.3s ease;
    }

    .member-card:hover, .commission-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0,0,0,0.1);
        border-color: #3b82f6;
    }

    .member-header, .commission-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        flex-wrap: wrap;
        gap: 10px;
    }

    .member-name, .commission-name {
        font-size: 1.3em;
        font-weight: bold;
        color: #1e40af;
    }

    .member-info, .commission-info {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 15px;
    }

    .info-item {
        display: flex;
        flex-direction: column;
    }

    .info-label {
        font-size: 0.9em;
        color: #6b7280;
        margin-bottom: 5px;
    }

    .info-value {
        font-weight: 500;
    }

    .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
    }

    .form-section {
        background: #f8fafc;
        padding: 25px;
        border-radius: 15px;
        margin-bottom: 30px;
        border: 2px solid #e5e7eb;
    }

    .form-section h3 {
        color: #1e40af;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 2px solid #3b82f6;
    }

    .sub-commission {
        background: white;
        border: 2px solid #fbbf24;
        border-radius: 10px;
        padding: 15px;
        margin-top: 15px;
    }

    .sub-commission-header {
        font-weight: bold;
        color: #f59e0b;
        margin-bottom: 10px;
    }

    .documents-section {
        background: #f0f9ff;
        border: 2px solid #0ea5e9;
        border-radius: 15px;
        padding: 20px;
        margin-top: 20px;
    }

    .documents-header {
        font-weight: bold;
        color: #0ea5e9;
        margin-bottom: 15px;
        font-size: 1.1em;
    }

    .document-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: white;
        padding: 12px 15px;
        border-radius: 8px;
        margin-bottom: 10px;
        border: 1px solid #e0f2fe;
    }

    .document-name {
        font-weight: 500;
        color: #0f172a;
    }

    .document-info {
        font-size: 0.9em;
        color: #64748b;
    }

    .file-upload-area {
        border: 2px dashed #3b82f6;
        border-radius: 10px;
        padding: 30px;
        text-align: center;
        background: #f8fafc;
        margin-bottom: 20px;
        transition: all 0.3s ease;
    }

    .file-upload-area:hover {
        background: #e0e7ff;
        border-color: #1e40af;
    }

    .file-upload-area.drag-over {
        background: #dbeafe;
        border-color: #2563eb;
        transform: scale(1.02);
    }

    .success-message {
        background: #d1fae5;
        border: 2px solid #10b981;
        color: #065f46;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 20px;
        text-align: center;
        font-weight: 600;
    }

    .error-message {
        background: #fee2e2;
        border: 2px solid #ef4444;
        color: #991b1b;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 20px;
        text-align: center;
        font-weight: 600;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .stat-card {
        background: linear-gradient(135deg, #3b82f6, #1e40af);
        color: white;
        padding: 25px;
        border-radius: 15px;
        text-align: center;
        box-shadow: 0 10px 25px rgba(59, 130, 246, 0.2);
    }

    .stat-number {
        font-size: 2.5em;
        font-weight: bold;
        margin-bottom: 5px;
    }

    .stat-label {
        font-size: 0.9em;
        opacity: 0.9;
    }

    @media (max-width: 768px) {
        .nav-tabs {
            flex-direction: column;
        }
        
        .form-grid, .form-row {
            grid-template-columns: 1fr;
        }
        
        .member-info, .commission-info {
            grid-template-columns: 1fr;
        }

        .member-header, .commission-header {
            flex-direction: column;
            align-items: flex-start;
        }

        .stats-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
```

</head>
<body>
    <!-- Écran de connexion -->
    <div id="loginScreen" class="login-container">
        <div class="login-box">
            <div class="logo">AE2i</div>
            <div class="subtitle">Base de données universelle</div>
            <input type="password" id="passwordInput" placeholder="Mot de passe" />
            <button class="btn btn-primary" onclick="login()" style="width: 100%;">Se connecter</button>
            <div id="loginError" class="error-message hidden">Mot de passe incorrect</div>
        </div>
    </div>

```
<!-- Interface principale -->
<div id="mainApp" class="hidden">
    <div class="container">
        <div class="main-container">
            <div class="header">
                <h1>AE2i - Gestion des données</h1>
                <p>Base de données universelle synchronisée</p>
            </div>
            
            <div class="nav-tabs">
                <div class="nav-tab active" onclick="showTab('dashboard')">Tableau de bord</div>
                <div class="nav-tab" onclick="showTab('members')">Membres</div>
                <div class="nav-tab" onclick="showTab('commissions')">Commissions</div>
                <div class="nav-tab" onclick="showTab('documents')">Documents</div>
                <div class="nav-tab" onclick="showTab('settings')">Paramètres</div>
            </div>

            <!-- Onglet Tableau de bord -->
            <div id="dashboardTab" class="tab-content">
                <h2>Tableau de bord AE2i</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalMembers">0</div>
                        <div class="stat-label">Membres totaux</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="activeMembers">0</div>
                        <div class="stat-label">Membres actifs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalCommissions">0</div>
                        <div class="stat-label">Commissions</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalDocuments">0</div>
                        <div class="stat-label">Documents</div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Activité récente</h3>
                    <div id="recentActivity">
                        <!-- Activité récente sera affichée ici -->
                    </div>
                </div>
            </div>

            <!-- Onglet Membres -->
            <div id="membersTab" class="tab-content hidden">
                <h2>Gestion des Membres</h2>
                
                <div id="memberSuccess" class="success-message hidden">Membre sauvegardé avec succès !</div>
                
                <div class="form-section">
                    <h3>Informations personnelles</h3>
                    <div class="form-grid">
                        <div>
                            <input type="text" id="memberName" placeholder="Nom complet *" />
                        </div>
                        <div>
                            <input type="email" id="memberEmail" placeholder="Email *" />
                        </div>
                        <div>
                            <input type="tel" id="memberPhone" placeholder="Téléphone" />
                        </div>
                        <div>
                            <input type="date" id="memberJoinDate" />
                            <label style="font-size: 0.9em; color: #6b7280;">Date d'intégration *</label>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Informations professionnelles</h3>
                    <div class="form-grid">
                        <div>
                            <input type="text" id="memberPosition" placeholder="Poste/Fonction" />
                        </div>
                        <div>
                            <select id="memberStatus">
                                <option value="">Statut du membre</option>
                                <option value="actif">Actif</option>
                                <option value="inactif">Inactif</option>
                                <option value="suspendu">Suspendu</option>
                                <option value="honoraire">Membre d'honneur</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" id="memberAddress" placeholder="Adresse complète" />
                        </div>
                        <div>
                            <input type="text" id="memberCompany" placeholder="Entreprise/Organisation" />
                        </div>
                    </div>
                    
                    <div>
                        <textarea id="memberNotes" placeholder="Notes supplémentaires" rows="3"></textarea>
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="saveMember()">Ajouter Membre</button>
                <button class="btn btn-warning" onclick="updateMember()" id="updateMemberBtn" style="display: none;">Mettre à jour</button>
                <button class="btn btn-danger" onclick="cancelEdit()" id="cancelEditBtn" style="display: none;">Annuler</button>
                
                <div id="membersList">
                    <!-- Les membres seront affichés ici -->
                </div>
            </div>

            <!-- Onglet Commissions -->
            <div id="commissionsTab" class="tab-content hidden">
                <h2>Gestion des Commissions</h2>
                
                <div id="commissionSuccess" class="success-message hidden">Commission sauvegardée avec succès !</div>
                
                <div class="form-section">
                    <h3>Informations générales</h3>
                    <div class="form-grid">
                        <div>
                            <input type="text" id="commissionName" placeholder="Nom de la commission *" />
                        </div>
                        <div>
                            <input type="text" id="commissionCode" placeholder="Code commission (ex: TRES, COMM, etc.)" />
                        </div>
                    </div>
                    
                    <div>
                        <textarea id="commissionDescription" placeholder="Description de la commission" rows="3"></textarea>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Responsables</h3>
                    <div class="form-grid">
                        <div>
                            <input type="text" id="commissionResponsible" placeholder="Responsable principal *" />
                        </div>
                        <div>
                            <input type="text" id="commissionAdjoint" placeholder="Adjoint" />
                        </div>
                        <div>
                            <input type="text" id="commissionSecretary" placeholder="Secrétaire" />
                        </div>
                        <div>
                            <input type="text" id="commissionTreasurer" placeholder="Trésorier (si applicable)" />
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Sous-commissions</h3>
                    <div>
                        <textarea id="commissionSubCommissions" placeholder="Sous-commissions (une par ligne)" rows="4"></textarea>
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="saveCommission()">Ajouter Commission</button>
                <button class="btn btn-warning" onclick="updateCommission()" id="updateCommissionBtn" style="display: none;">Mettre à jour</button>
                <button class="btn btn-danger" onclick="cancelCommissionEdit()" id="cancelCommissionEditBtn" style="display: none;">Annuler</button>
                
                <div id="commissionsList">
                    <!-- Les commissions seront affichées ici -->
                </div>
            </div>

            <!-- Onglet Documents -->
            <div id="documentsTab" class="tab-content hidden">
                <h2>Gestion des Documents</h2>
                
                <div id="documentSuccess" class="success-message hidden">Document traité avec succès !</div>
                <div id="documentError" class="error-message hidden"></div>
                
                <div class="form-section">
                    <h3>Importer des documents</h3>
                    <div class="file-upload-area" id="fileUploadArea">
                        <p><strong>Glissez-déposez vos fichiers ici</strong></p>
                        <p>ou</p>
                        <input type="file" id="fileInput" multiple accept=".xlsx,.xls,.pdf,.doc,.docx,.png,.jpg,.jpeg" style="margin-top: 15px;">
                        <p style="font-size: 0.9em; color: #6b7280; margin-top: 10px;">
                            Formats supportés: Excel (.xlsx, .xls), PDF, Word, Images
                        </p>
                    </div>

                    <div class="form-row">
                        <div>
                            <select id="documentCommission">
                                <option value="">Associer à une commission (optionnel)</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" id="documentCategory" placeholder="Catégorie (ex: Budget, Rapport, Statuts)" />
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Actions rapides</h3>
                    <button class="btn btn-success" onclick="exportMembersExcel()">📊 Exporter Membres (Excel)</button>
                    <button class="btn btn-success" onclick="exportCommissionsExcel()">📊 Exporter Commissions (Excel)</button>
                    <button class="btn btn-warning" onclick="generateReport()">📋 Générer Rapport Complet</button>
                </div>

                <div id="documentsList" class="form-section">
                    <h3>Documents enregistrés</h3>
                    <div id="documentsContainer">
                        <!-- Les documents seront affichés ici -->
                    </div>
                </div>
            </div>

            <!-- Onglet Paramètres -->
            <div id="settingsTab" class="tab-content hidden">
                <h2>Paramètres</h2>
                
                <div id="settingsSuccess" class="success-message hidden">Paramètres mis à jour avec succès !</div>
                
                <div class="form-section">
                    <h3>Changer le mot de passe</h3>
                    <div style="max-width: 400px;">
                        <input type="password" id="currentPassword" placeholder="Mot de passe actuel" />
                        <input type="password" id="newPassword" placeholder="Nouveau mot de passe" />
                        <input type="password" id="confirmPassword" placeholder="Confirmer le nouveau mot de passe" />
                        <button class="btn btn-primary" onclick="changePassword()">Changer le mot de passe</button>
                    </div>
                    
                    <div id="passwordError" class="error-message hidden"></div>
                </div>
                
                <div class="form-section">
                    <h3>Sauvegarde des données</h3>
                    <p>Les données sont automatiquement sauvegardées à chaque modification.</p>
                    <p>Dernière sauvegarde : <span id="lastSave">Jamais</span></p>
                    <button class="btn btn-warning" onclick="exportAllData()">📥 Exporter toutes les données</button>
                    <button class="btn btn-primary" onclick="importData()">📤 Importer des données</button>
                    <input type="file" id="importFileInput" accept=".json" style="display: none;">
                </div>

                <div class="form-section">
                    <h3>Informations système</h3>
                    <p>Version : 2.0</p>
                    <p>Dernière mise à jour : <span id="lastUpdate"></span></p>
                    <p>Nombre total d'enregistrements : <span id="totalRecords">0</span></p>
                </div>
                
                <div class="form-section">
                    <button class="btn btn-danger" onclick="logout()">Se déconnecter</button>
                    <button class="btn btn-danger" onclick="clearAllData()" style="margin-left: 10px;">⚠️ Effacer toutes les données</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
    // Variables globales
    let currentPassword = 'ae2i2024';
    let members = JSON.parse(localStorage.getItem('ae2i_members') || '[]');
    let commissions = JSON.parse(localStorage.getItem('ae2i_commissions') || '[]');
    let documents = JSON.parse(localStorage.getItem('ae2i_documents') || '[]');
    let recentActivity = JSON.parse(localStorage.getItem('ae2i_activity') || '[]');
    let editingMemberIndex = -1;
    let editingCommissionIndex = -1;

    // Fonction de connexion
    function login() {
        const password = document.getElementById('passwordInput').value;
        if (password === currentPassword) {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            loadData();
            updateDashboard();
        } else {
            document.getElementById('loginError').classList.remove('hidden');
            setTimeout(() => {
                document.getElementById('loginError').classList.add('hidden');
            }, 3000);
        }
    }

    // Gestion des onglets
    function showTab(tabName) {
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.add('hidden');
        });
        
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.classList.remove('active');
        });
        
        document.getElementById(tabName + 'Tab').classList.remove('hidden');
        event.target.classList.add('active');

        if (tabName === 'dashboard') {
            updateDashboard();
        } else if (tabName === 'documents') {
            updateCommissionsList();
            displayDocuments();
        }
    }

    // Mise à jour du tableau de bord
    function updateDashboard() {
        document.getElementById('totalMembers').textContent = members.length;
        document.getElementById('activeMembers').textContent = members.filter(m => m.status === 'actif').length;
        document.getElementById('totalCommissions').textContent = commissions.length;
        document.getElementById('totalDocuments').textContent = documents.length;
        document.getElementById('totalRecords').textContent = members.length + commissions.length + documents.length;
        document.getElementById('lastUpdate').textContent = new Date().toLocaleString('fr-FR');

        // Affichage de l'activité récente
        const activityContainer = document.getElementById('recentActivity');
        activityContainer.innerHTML = '';
        
        const recent = recentActivity.slice(0, 5);
        if (recent.length === 0) {
            activityContainer.innerHTML = '<p style="color: #6b7280;">Aucune activité récente</p>';
        } else {
            recent.forEach(activity => {
                const activityDiv = document.createElement('div');
                activityDiv.style.cssText = 'padding: 10px; margin-bottom: 10px; background: white; border-radius: 8px; border-left: 4px solid #3b82f6;';
                activityDiv.innerHTML = `
                    <strong>${activity.action}</strong> - ${activity.details}
                    <br><small style="color: #6b7280;">${activity.date}</small>
                `;
                activityContainer.appendChild(activityDiv);
            });
        }
    }

    // Ajouter une activité
    function addActivity(action, details) {
        const activity = {
            action: action,
            details: details,
            date: new Date().toLocaleString('fr-FR')
        };
        recentActivity.unshift(activity);
        if (recentActivity.length > 50) {
            recentActivity = recentActivity.slice(0, 50);
        }
        localStorage.setItem('ae2i_activity', JSON.stringify(recentActivity));
    }

    // Gestion des membres (mise à jour)
    function saveMember() {
        const name = document.getElementById('memberName').value;
        const email = document.getElementById('memberEmail').value;
        const joinDate = document.getElementById('memberJoinDate').value;
        
        if (!name || !email || !joinDate) {
            alert('Le nom, l\'email et la date d\'intégration sont obligatoires');
            return;
        }

        const member = {
            id: Date.now(),
            name: name,
            email: email,
            phone: document.getElementById('memberPhone').value,
            position: document.getElementById('memberPosition').value,
            address: document.getElementById('memberAddress').value,
            company: document.getElementById('memberCompany').value,
            status: document.getElementById('memberStatus').value,
            notes: document.getElementById('memberNotes').value,
            joinDate: joinDate,
            dateAdded: new Date().toLocaleDateString('fr-FR')
        };

        members.push(member);
        addActivity('Nouveau membre', `${name} ajouté à la base`);
        saveData();
        clearMemberForm();
        displayMembers();
        showSuccess('memberSuccess');
    }

    function updateMember() {
        const name = document.getElementById('memberName').value;
        const email = document.getElementById('memberEmail').value;
        const joinDate = document.getElementById('memberJoinDate').value;
        
        if (!name || !email || !joinDate) {
            alert('Le nom, l\'email et la date d\'intégration sont obligatoires');
            return;
        }

        members[editingMemberIndex] = {
            ...members[editingMemberIndex],
            name: name,
            email: email,
            phone: document.getElementById('memberPhone').value,
            position: document.getElementById('memberPosition').value,
            address: document.getElementById('memberAddress').value,
            company: document.getElementById('memberCompany').value,
            status: document.getElementById('memberStatus').value,
            notes: document.getElementById('memberNotes').value,
            joinDate: joinDate
        };

        addActivity('Membre modifié', `${name} mis à jour`);
        saveData();
        clearMemberForm();
        displayMembers();
        showSuccess('memberSuccess');
        cancelEdit();
    }

    function editMember(index) {
        const member = members[index];
        editingMemberIndex = index;

        document.getElementById('memberName').value = member.name;
        document.getElementById('memberEmail').value = member.email;
        document.getElementById('memberPhone').value = member.phone || '';
        document.getElementById('memberPosition').value = member.position || '';
        document.getElementById('memberAddress').value = member.address || '';
        document.getElementById('memberCompany').value = member.company || '';
        document.getElementById('memberStatus').value = member.status || '';
        document.getElementById('memberNotes').value = member.notes || '';
        document.getElementById('memberJoinDate').value = member.joinDate || '';

        document.getElementById('updateMemberBtn').style.display = 'inline-block';
        document.getElementById('cancelEditBtn').style.display = 'inline-block';
    }

    function deleteMember(index) {
        if (confirm('Êtes-vous sûr de vouloir supprimer ce membre ?')) {
            const memberName = members[index].name;
            members.splice(index, 1);
            addActivity('Membre supprimé', `${memberName} retiré de la base`);
            saveData();
            displayMembers();
        }
    }

    function cancelEdit() {
        editingMemberIndex = -1;
        clearMemberForm();
        document.getElementById('updateMemberBtn').style.display = 'none';
        document.getElementById('cancelEditBtn').style.display = 'none';
    }

    function clearMemberForm() {
        document.getElementById('memberName').value = '';
        document.getElementById('memberEmail').value = '';
        document.getElementById('memberPhone').value = '';
        document.getElementById('memberPosition').value = '';
        document.getElementById('memberAddress').value = '';
        document.getElementById('memberCompany').value = '';
        document.getElementById('memberStatus').value = '';
        document.getElementById('memberNotes').value = '';
        document.getElementById('memberJoinDate').value = '';
    }

    function displayMembers() {
        const membersList = document.getElementById('membersList');
        membersList.innerHTML = '';

        members.forEach((member, index) => {
            const memberCard = document.createElement('div');
            memberCard.className = 'member-card';
            memberCard.innerHTML = `
                <div class="member-header">
                    <div class="member-name">${member.name}</div>
                    <div>
                        <button class="btn btn-warning btn-small" onclick="editMember(${index})">Modifier</button>
                        <button class="btn btn-danger btn-small" onclick="deleteMember(${index})">Supprimer</button>
                    </div>
                </div>
                <div class="member-info">
                    <div class="info-item">
                        <div class="info-label">Email</div>
                        <div class="info-value">${member.email}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Téléphone</div>
                        <div class="info-value">${member.phone || 'Non renseigné'}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Date d'intégration</div>
                        <div class="info-value">${member.joinDate ? new Date(member.joinDate).toLocaleDateString('fr-FR') : 'Non renseignée'}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Poste</div>
                        <div class="info-value">${member.position || 'Non renseigné'}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Entreprise</div>
                        <div class="info-value">${member.company || 'Non renseignée'}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Statut</div>
                        <div class="info-value">${member.status || 'Non défini'}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Adresse</div>
                        <div class="info-value">${member.address || 'Non renseignée'}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Ajouté le</div>
                        <div class="info-value">${member.dateAdded}</div>
                    </div>
                </div>
                ${member.notes ? `<div style="margin-top: 15px; padding: 15px; background: white; border-radius: 8px;"><strong>Notes:</strong> ${member.notes}</div>` : ''}
            `;
            membersList.appendChild(memberCard);
        });
    }

    // Gestion des commissions (mise à jour)
    function saveCommission() {
        const name = document.getElementById('commissionName').value;
        const responsible = document.getElementById('commissionResponsible').value;
        
        if (!name || !responsible) {
            alert('Le nom de la commission et le responsable sont obligatoires');
            return;
        }

        const subCommissionsText = document.getElementById('commissionSubCommissions').value;
        const subCommissions = subCommissionsText.split('\n').filter(sc => sc.trim() !== '');

        const commission = {
            id: Date.now(),
            name: name,
            code: document.getElementById('commissionCode').value,
            responsible: responsible,
            adjoint: document.getElementById('commissionAdjoint').value,
            secretary: document.getElementById('commissionSecretary').value,
            treasurer: document.getElementById('commissionTreasurer').value,
            description: document.getElementById('commissionDescription').value,
            subCommissions: subCommissions,
            dateAdded: new Date().toLocaleDateString('fr-FR')
        };

        commissions.push(commission);
        addActivity('Nouvelle commission', `${name} créée`);
        saveData();
        clearCommissionForm();
        displayCommissions();
        showSuccess('commissionSuccess');
    }

    function updateCommission() {
        const name = document.getElementById('commissionName').value;
        const responsible = document.getElementById('commissionResponsible').value;
        
        if (!name || !responsible) {
            alert('Le nom de la commission et le responsable sont obligatoires');
            return;
        }

        const subCommissionsText = document.getElementById('commissionSubCommissions').value;
        const subCommissions = subCommissionsText.split('\n').filter(sc => sc.trim() !== '');

        commissions[editingCommissionIndex] = {
            ...commissions[editingCommissionIndex],
            name: name,
            code: document.getElementById('commissionCode').value,
            responsible: responsible,
            adjoint: document.getElementById('commissionAdjoint').value,
            secretary: document.getElementById('commissionSecretary').value,
            treasurer: document.getElementById('commissionTreasurer').value,
            description: document.getElementById('commissionDescription').value,
            subCommissions: subCommissions
        };

        addActivity('Commission modifiée', `${name} mise à jour`);
        saveData();
        clearCommissionForm();
        displayCommissions();
        showSuccess('commissionSuccess');
        cancelCommissionEdit();
    }

    function editCommission(index) {
        const commission = commissions[index];
        editingCommissionIndex = index;

        document.getElementById('commissionName').value = commission.name;
        document.getElementById('commissionCode').value = commission.code || '';
        document.getElementById('commissionResponsible').value = commission.responsible || '';
        document.getElementById('commissionAdjoint').value = commission.adjoint || '';
        document.getElementById('commissionSecretary').value = commission.secretary || '';
        document.getElementById('commissionTreasurer').value = commission.treasurer || '';
        document.getElementById('commissionDescription').value = commission.description || '';
        document.getElementById('commissionSubCommissions').value = commission.subCommissions ? commission.subCommissions.join('\n') : '';

        document.getElementById('updateCommissionBtn').style.display = 'inline-block';
        document.getElementById('cancelCommissionEditBtn').style.display = 'inline-block';
    }

    function deleteCommission(index) {
        if (confirm('Êtes-vous sûr de vouloir supprimer cette commission ?')) {
            const commissionName = commissions[index].name;
            commissions.splice(index, 1);
            addActivity('Commission supprimée', `${commissionName} supprimée`);
            saveData();
            displayCommissions();
        }
    }

    function cancelCommissionEdit() {
        editingCommissionIndex = -1;
        clearCommissionForm();
        document.getElementById('updateCommissionBtn').style.display = 'none';
        document.getElementById('cancelCommissionEditBtn').style.display = 'none';
    }

    function clearCommissionForm() {
        document.getElementById('commissionName').value = '';
        document.getElementById('commissionCode').value = '';
        document.getElementById('commissionResponsible').value = '';
        document.getElementById('commissionAdjoint').value = '';
        document.getElementById('commissionSecretary').value = '';
        document.getElementById('commissionTreasurer').value = '';
        document.getElementById('commissionDescription').value = '';
        document.getElementById('commissionSubCommissions').value = '';
    }

    function displayCommissions() {
        const commissionsList = document.getElementById('commissionsList');
        commissionsList.innerHTML = '';

        commissions.forEach((commission, index) => {
            const commissionCard = document.createElement('div');
            commissionCard.className = 'commission-card';
            
            let subCommissionsHTML = '';
            if (commission.subCommissions && commission.subCommissions.length > 0) {
                subCommissionsHTML = '<div style="margin-top: 15px;"><strong>Sous-commissions:</strong>';
                commission.subCommissions.forEach(sc => {
                    subCommissionsHTML += `<div class="sub-commission"><div class="sub-commission-header">${sc}</div></div>`;
                });
                subCommissionsHTML += '</div>';
            }

            commissionCard.innerHTML = `
                <div class="commission-header">
                    <div>
                        <div class="commission-name">${commission.name}</div>
                        ${commission.code ? `<div style="color: #6b7280; font-size: 0.9em;">Code: ${commission.code}</div>` : ''}
                    </div>
                    <div>
                        <button class="btn btn-warning btn-small" onclick="editCommission(${index})">Modifier</button>
                        <button class="btn btn-danger btn-small" onclick="deleteCommission(${index})">Supprimer</button>
                    </div>
                </div>
                <div class="commission-info">
                    <div class="info-item">
                        <div class="info-label">Responsable</div>
                        <div class="info-value">${commission.responsible || 'Non renseigné'}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Adjoint</div>
                        <div class="info-value">${commission.adjoint || 'Non renseigné'}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Secrétaire</div>
                        <div class="info-value">${commission.secretary || 'Non renseigné'}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Trésorier</div>
                        <div class="info-value">${commission.treasurer || 'Non applicable'}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Date de création</div>
                        <div class="info-value">${commission.dateAdded}</div>
                    </div>
                </div>
                ${commission.description ? `<div style="margin-top: 15px; padding: 15px; background: white; border-radius: 8px;"><strong>Description:</strong> ${commission.description}</div>` : ''}
                ${subCommissionsHTML}
            `;
            commissionsList.appendChild(commissionCard);
        });
    }

    // Gestion des documents
    function setupFileUpload() {
        const fileInput = document.getElementById('fileInput');
        const fileUploadArea = document.getElementById('fileUploadArea');

        fileInput.addEventListener('change', handleFileSelect);
        
        // Drag and drop
        fileUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUploadArea.classList.add('drag-over');
        });

        fileUploadArea.addEventListener('dragleave', () => {
            fileUploadArea.classList.remove('drag-over');
        });

        fileUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUploadArea.classList.remove('drag-over');
            const files = e.dataTransfer.files;
            handleFiles(files);
        });
    }

    function handleFileSelect(e) {
        const files = e.target.files;
        handleFiles(files);
    }

    function handleFiles(files) {
        Array.from(files).forEach(file => {
            if (file.size > 50 * 1024 * 1024) { // 50MB limit
                showError('documentError', `Le fichier ${file.name} est trop volumineux (max 50MB)`);
                return;
            }

            const document = {
                id: Date.now() + Math.random(),
                name: file.name,
                size: file.size,
                type: file.type,
                commission: document.getElementById('documentCommission').value,
                category: document.getElementById('documentCategory').value,
                dateAdded: new Date().toLocaleDateString('fr-FR'),
                data: null // In a real app, you'd upload to a server
            };

            // For Excel files, try to read content
            if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const workbook = XLSX.read(e.target.result, {type: 'binary'});
                        document.excelData = {
                            sheetNames: workbook.SheetNames,
                            sheets: {}
                        };
                        workbook.SheetNames.forEach(sheetName => {
                            const worksheet = workbook.Sheets[sheetName];
                            document.excelData.sheets[sheetName] = XLSX.utils.sheet_to_json(worksheet);
                        });
                        documents.push(document);
                        addActivity('Document ajouté', `${file.name} importé`);
                        saveData();
                        displayDocuments();
                        showSuccess('documentSuccess');
                    } catch (error) {
                        showError('documentError', `Erreur lors de la lecture du fichier Excel: ${file.name}`);
                    }
                };
                reader.readAsBinaryString(file);
            } else {
                // For other file types, just store metadata
                documents.push(document);
                addActivity('Document ajouté', `${file.name} importé`);
                saveData();
                displayDocuments();
                showSuccess('documentSuccess');
            }
        });

        // Clear form
        document.getElementById('fileInput').value = '';
        document.getElementById('documentCommission').value = '';
        document.getElementById('documentCategory').value = '';
    }

    function displayDocuments() {
        const container = document.getElementById('documentsContainer');
        container.innerHTML = '';

        if (documents.length === 0) {
            container.innerHTML = '<p style="color: #6b7280; text-align: center; padding: 20px;">Aucun document enregistré</p>';
            return;
        }

        documents.forEach((doc, index) => {
            const docDiv = document.createElement('div');
            docDiv.className = 'document-item';
            
            const sizeStr = (doc.size / 1024).toFixed(1) + ' Ko';
            const commission = doc.commission ? ` • Commission: ${doc.commission}` : '';
            const category = doc.category ? ` • ${doc.category}` : '';

            docDiv.innerHTML = `
                <div>
                    <div class="document-name">📄 ${doc.name}</div>
                    <div class="document-info">${sizeStr} • ${doc.dateAdded}${commission}${category}</div>
                </div>
                <div>
                    ${doc.excelData ? `<button class="btn btn-success btn-small" onclick="viewExcelData(${index})">Voir données</button>` : ''}
                    <button class="btn btn-danger btn-small" onclick="deleteDocument(${index})">Supprimer</button>
                </div>
            `;
            container.appendChild(docDiv);
        });
    }

    function deleteDocument(index) {
        if (confirm('Êtes-vous sûr de vouloir supprimer ce document ?')) {
            const docName = documents[index].name;
            documents.splice(index, 1);
            addActivity('Document supprimé', `${docName} supprimé`);
            saveData();
            displayDocuments();
        }
    }

    function viewExcelData(index) {
        const doc = documents[index];
        if (!doc.excelData) return;

        let content = `<h3>Données Excel: ${doc.name}</h3>`;
        
        doc.excelData.sheetNames.forEach(sheetName => {
            const sheetData = doc.excelData.sheets[sheetName];
            content += `<h4>Feuille: ${sheetName} (${sheetData.length} lignes)</h4>`;
            
            if (sheetData.length > 0) {
                const headers = Object.keys(sheetData[0]);
                content += '<div style="overflow-x: auto; margin-bottom: 20px;"><table style="width: 100%; border-collapse: collapse;">';
                
                // Headers
                content += '<tr>';
                headers.forEach(header => {
                    content += `<th style="border: 1px solid #ddd; padding: 8px; background: #f8fafc;">${header}</th>`;
                });
                content += '</tr>';
                
                // Data (first 10 rows)
                sheetData.slice(0, 10).forEach(row => {
                    content += '<tr>';
                    headers.forEach(header => {
                        content += `<td style="border: 1px solid #ddd; padding: 8px;">${row[header] || ''}</td>`;
                    });
                    content += '</tr>';
                });
                
                if (sheetData.length > 10) {
                    content += `<tr><td colspan="${headers.length}" style="text-align: center; padding: 10px; font-style: italic;">... et ${sheetData.length - 10} autres lignes</td></tr>`;
                }
                
                content += '</table></div>';
            }
        });

        // Create modal
        const modal = document.createElement('div');
        modal.style.cssText = `
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.5); z-index: 1000; display: flex; 
            justify-content: center; align-items: center; padding: 20px;
        `;
        
        const modalContent = document.createElement('div');
        modalContent.style.cssText = `
            background: white; border-radius: 15px; padding: 30px; 
            max-width: 90%; max-height: 90%; overflow-y: auto;
        `;
        modalContent.innerHTML = content + `
            <button class="btn btn-primary" onclick="document.body.removeChild(document.querySelector('[style*=\"position: fixed\"]'))">Fermer</button>
        `;
        
        modal.appendChild(modalContent);
        document.body.appendChild(modal);
    }

    function updateCommissionsList() {
        const select = document.getElementById('documentCommission');
        select.innerHTML = '<option value="">Associer à une commission (optionnel)</option>';
        
        commissions.forEach(commission => {
            const option = document.createElement('option');
            option.value = commission.name;
            option.textContent = commission.name;
            select.appendChild(option);
        });
    }

    // Export functions
    function exportMembersExcel() {
        if (members.length === 0) {
            alert('Aucun membre à exporter');
            return;
        }

        const worksheet = XLSX.utils.json_to_sheet(members.map(member => ({
            'Nom': member.name,
            'Email': member.email,
            'Téléphone': member.phone || '',
            'Poste': member.position || '',
            'Entreprise': member.company || '',
            'Adresse': member.address || '',
            'Statut': member.status || '',
            'Date d\'intégration': member.joinDate || '',
            'Date d\'ajout': member.dateAdded,
            'Notes': member.notes || ''
        })));

        const workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(workbook, worksheet, 'Membres AE2i');
        XLSX.writeFile(workbook, `ae2i_membres_${new Date().toISOString().split('T')[0]}.xlsx`);
        
        addActivity('Export Excel', 'Liste des membres exportée');
    }

    function exportCommissionsExcel() {
        if (commissions.length === 0) {
            alert('Aucune commission à exporter');
            return;
        }

        const worksheet = XLSX.utils.json_to_sheet(commissions.map(commission => ({
            'Nom': commission.name,
            'Code': commission.code || '',
            'Responsable': commission.responsible || '',
            'Adjoint': commission.adjoint || '',
            'Secrétaire': commission.secretary || '',
            'Trésorier': commission.treasurer || '',
            'Description': commission.description || '',
            'Sous-commissions': commission.subCommissions ? commission.subCommissions.join('; ') : '',
            'Date de création': commission.dateAdded
        })));

        const workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(workbook, worksheet, 'Commissions AE2i');
        XLSX.writeFile(workbook, `ae2i_commissions_${new Date().toISOString().split('T')[0]}.xlsx`);
        
        addActivity('Export Excel', 'Liste des commissions exportée');
    }

    function generateReport() {
        const reportData = {
            'Rapport général AE2i': [
                {'Statistique': 'Nombre total de membres', 'Valeur': members.length},
                {'Statistique': 'Membres actifs', 'Valeur': members.filter(m => m.status === 'actif').length},
                {'Statistique': 'Membres inactifs', 'Valeur': members.filter(m => m.status === 'inactif').length},
                {'Statistique': 'Nombre de commissions', 'Valeur': commissions.length},
                {'Statistique': 'Documents stockés', 'Valeur': documents.length},
                {'Statistique': 'Date du rapport', 'Valeur': new Date().toLocaleString('fr-FR')}
            ]
        };

        const workbook = XLSX.utils.book_new();
        
        // Add summary sheet
        const summaryWs = XLSX.utils.json_to_sheet(reportData['Rapport général AE2i']);
        XLSX.utils.book_append_sheet(workbook, summaryWs, 'Résumé');

        // Add members sheet if available
        if (members.length > 0) {
            const membersWs = XLSX.utils.json_to_sheet(members);
            XLSX.utils.book_append_sheet(workbook, membersWs, 'Membres');
        }

        // Add commissions sheet if available
        if (commissions.length > 0) {
            const commissionsWs = XLSX.utils.json_to_sheet(commissions);
            XLSX.utils.book_append_sheet(workbook, commissionsWs, 'Commissions');
        }

        XLSX.writeFile(workbook, `ae2i_rapport_complet_${new Date().toISOString().split('T')[0]}.xlsx`);
        
        addActivity('Rapport généré', 'Rapport complet exporté');
    }

    // Settings functions
    function changePassword() {
        const current = document.getElementById('currentPassword').value;
        const newPass = document.getElementById('newPassword').value;
        const confirm = document.getElementById('confirmPassword').value;
        const errorDiv = document.getElementById('passwordError');

        if (!current || !newPass || !confirm) {
            showError('passwordError', 'Tous les champs sont obligatoires');
            return;
        }

        if (current !== currentPassword) {
            showError('passwordError', 'Mot de passe actuel incorrect');
            return;
        }

        if (newPass !== confirm) {
            showError('passwordError', 'Les nouveaux mots de passe ne correspondent pas');
            return;
        }

        if (newPass.length < 6) {
            showError('passwordError', 'Le nouveau mot de passe doit contenir au moins 6 caractères');
            return;
        }

        currentPassword = newPass;
        localStorage.setItem('ae2i_password', currentPassword);
        
        document.getElementById('currentPassword').value = '';
        document.getElementById('newPassword').value = '';
        document.getElementById('confirmPassword').value = '';
        
        errorDiv.classList.add('hidden');
        showSuccess('settingsSuccess');
        addActivity('Sécurité', 'Mot de passe modifié');
    }

    function exportAllData() {
        const data = {
            members: members,
            commissions: commissions,
            documents: documents.map(doc => ({...doc, data: null})), // Remove file data for export
            recentActivity: recentActivity,
            exportDate: new Date().toLocaleString('fr-FR'),
            version: '2.0'
        };

        const dataStr = JSON.stringify(data, null, 2);
        const dataBlob = new Blob([dataStr], {type: 'application/json'});
        const url = URL.createObjectURL(dataBlob);
        
        const link = document.createElement('a');
        link.href = url;
        link.download = `ae2i_sauvegarde_complete_${new Date().toISOString().split('T')[0]}.json`;
        link.click();
        
        URL.revokeObjectURL(url);
        addActivity('Sauvegarde', 'Données exportées complètement');
    }

    function importData() {
        document.getElementById('importFileInput').click();
    }

    function clearAllData() {
        if (confirm('⚠️ ATTENTION: Cette action supprimera TOUTES les données (membres, commissions, documents). Cette action est irréversible. Êtes-vous absolument sûr ?')) {
            if (confirm('Dernière confirmation: Voulez-vous vraiment effacer toutes les données AE2i ?')) {
                members = [];
                commissions = [];
                documents = [];
                recentActivity = [];
                
                localStorage.removeItem('ae2i_members');
                localStorage.removeItem('ae2i_commissions');
                localStorage.removeItem('ae2i_documents');
                localStorage.removeItem('ae2i_activity');
                
                displayMembers();
                displayCommissions();
                displayDocuments();
                updateDashboard();
                
                alert('Toutes les données ont été supprimées.');
            }
        }
    }

    function logout() {
        if (confirm('Êtes-vous sûr de vouloir vous déconnecter ?')) {
            document.getElementById('mainApp').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('passwordInput').value = '';
        }
    }

    // Utility functions
    function saveData() {
        localStorage.setItem('ae2i_members', JSON.stringify(members));
        localStorage.setItem('ae2i_commissions', JSON.stringify(commissions));
        localStorage.setItem('ae2i_documents', JSON.stringify(documents));
        localStorage.setItem('ae2i_activity', JSON.stringify(recentActivity));
        localStorage.setItem('ae2i_last_save', new Date().toLocaleString('fr-FR'));
        updateLastSave();
    }

    function loadData() {
        const savedPassword = localStorage.getItem('ae2i_password');
        if (savedPassword) {
            currentPassword = savedPassword;
        }

        members = JSON.parse(localStorage.getItem('ae2i_members') || '[]');
        commissions = JSON.parse(localStorage.getItem('ae2i_commissions') || '[]');
        documents = JSON.parse(localStorage.getItem('ae2i_documents') || '[]');
        recentActivity = JSON.parse(localStorage.getItem('ae2i_activity') || '[]');
        
        displayMembers();
        displayCommissions();
        displayDocuments();
        updateLastSave();
    }

    function updateLastSave() {
        const lastSave = localStorage.getItem('ae2i_last_save') || 'Jamais';
        document.getElementById('lastSave').textContent = lastSave;
    }

    function showSuccess(elementId) {
        const element = document.getElementById(elementId);
        element.classList.remove('hidden');
        setTimeout(() => {
            element.classList.add('hidden');
        }, 3000);
    }

    function showError(elementId, message) {
        const element = document.getElementById(elementId);
        element.textContent = message;
        element.classList.remove('hidden');
        setTimeout(() => {
            element.classList.add('hidden');
        }, 5000);
    }

    // Event listeners
    document.getElementById('passwordInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            login();
        }
    });

    // Import data handler
    document.getElementById('importFileInput').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(event) {
            try {
                const data = JSON.parse(event.target.result);
                
                if (data.members) members = data.members;
                if (data.commissions) commissions = data.commissions;
                if (data.documents) documents = data.documents;
                if (data.recentActivity) recentActivity = data.recentActivity;

                saveData();
                displayMembers();
                displayCommissions();
                displayDocuments();
                updateDashboard();
                
                showSuccess('settingsSuccess');
                addActivity('Import', 'Données importées depuis fichier');
                alert('Données importées avec succès !');
            } catch (error) {
                alert('Erreur lors de l\'importation: fichier invalide');
            }
        };
        reader.readAsText(file);
        
        // Reset input
        e.target.value = '';
    });

    // Auto-save every 30 seconds
    setInterval(saveData, 30000);

    // Sync simulation
    function simulateSync() {
        const syncIndicator = document.createElement('div');
        syncIndicator.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 1000;
            font-weight: 600;
            animation: slideIn 0.3s ease;
        `;
        syncIndicator.innerHTML = '✓ Données synchronisées';
        document.body.appendChild(syncIndicator);

        setTimeout(() => {
            syncIndicator.remove();
        }, 2000);
    }

    // Override saveData to show sync
    const originalSaveData = saveData;
    saveData = function() {
        originalSaveData();
        simulateSync();
    };

    // Initialize on load
    window.addEventListener('load', function() {
        const savedPassword = localStorage.getItem('ae2i_password');
        if (savedPassword) {
            currentPassword = savedPassword;
        }
        
        setupFileUpload();
    });

    // Add CSS animation
    const style = document.createElement('style');
    style.textContent = `
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    `;
    document.head.appendChild(style);
</script>
```

</body>
</html>
